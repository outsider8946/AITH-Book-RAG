FEATURE_EXTRACT_TEMPLATE = """Ваша задача — извлечь из предоставленного текста список сущностей и связей между ними.

Инструкции по извлечению сущностей:
1. Убедитесь, что названия сущностей являются именами собственными и не содержат прилагательных, местоимений или предлогов.
2. Включайте только те сущности, которые, по вашему мнению, важны и релевантны тексту.
3. Избегайте обобщённых (неспецифичных) сущностей.
4. Тип сущности должен быть указан строчными буквами в формате snake_case.
5. Названия сущностей должны быть в нижнем регистре.
6. ⚠️ Если в тексте одно и то же лицо, предмет или место упоминается под разными именами (например, «Эдмон», «Дантес», «неустрашимый искатель»), — объедините их в **одну сущность**.  
   — Выберите **наиболее каноничное, полное или часто встречающееся имя** в качестве основного названия (например: `эдмон дантес` → `эдмон`).  
   — В описании сущности **обязательно укажите все альтернативные имена и упоминания**, подтверждающие их идентичность, с цитатами из текста.

Инструкции по извлечению связей:
1. Извлекайте связи только между сущностями, которые вы уже упомянули в списке.
2. Убедитесь, что вы указываете связи исключительно между извлечёнными сущностями.
3. Тип связи должен быть указан строчными буквами в формате snake_case.
4. Названия «Сущность_1» и «Сущность_2» должны точно совпадать с названиями из списка сущностей.
5. Обе сущности (Сущность_1 и Сущность_2) обязательно должны присутствовать в списке сущностей.
6. Связь является направленной: от Сущности_1 к Сущности_2, то есть Сущность_1 → Сущность_2.
7. Если связь двунаправленная, добавьте две отдельные связи: прямую (e1 → e2) и обратную (e2 → e1).

Инструкции по описаниям:
1. Описания сущностей и связей должны отражать, как они представлены или упомянуты в тексте.
2. В описаниях обязательно приводите цитаты или выдержки из текста в качестве подтверждения.
3. Для объединённых сущностей опишите, **почему разные имена относятся к одной сущности**, опираясь на контекст (например: «"Эдмон" и "Дантес" — одно лицо, так как в тексте сказано: *"...каждый шаг Эдмона... Дантес расчистил землю..."*»).
4. Обязетально проверь, чтобы имена полей ответа совпавдали с именами в формате вывода!!!
5. Используй только ту информацию, которую нашел в тексте и ничего больше!!! Не пиши того, что не указано в тексте.

Формат вывода — JSON:
{format_instructions}

Текст:
{text}

Ответ предоставьте в указанном формате вывода на русском языке:
"""

CANONICAL_NAMES_TEMPLATE = """Вы — эксперт по роману «Граф Монте-Кристо». Ваша задача — объединить имена персонажей, которые относятся к одному и тому же лицу.

Определите, какие из них — разные упоминания одного человека. Для каждого уникального персонажа укажите:
- каноническое имя (наиболее полное и узнаваемое),
- список всех его псеводонимов и других названий из списка.

Указания:
1. Вы не путаете персонажей между собой.
2. Вы точно знаете за каким пресонажем закреплены какие псевдонимы.
3. В качестве канонического имени вы выбираете самое популярное его имя.
4. В псевдонимы вы также записываете то, как их называли в книге.
5. Все имена пишутся в нижнем регистре.

Формат ответа — JSON:
{format_instructions}

Имена:
{names}

Ответ:
"""

ANSWER_TEMPLATE = """Вы - эксперт по тексту. Ответье на вопрос ТОЛЬКО на основе контекста из графа знаний.
Указания:
1. Если информации нет — скажите: «В тексте об этом не говорится».
2. Не выдумывайте детали.
3. Упоминайте имена и связи из контекста


Вопрос:
{query}

Контекст из графа:
{context}

Ответ:
"""